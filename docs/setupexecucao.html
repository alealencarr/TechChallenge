
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia de Setup: .NET no Kubernetes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Slate & Amber -->
    <!-- Application Structure Plan: A single-page, top-down guide structure with a sticky navigation header for quick jumps. The layout is divided into clear, numbered sections (Arquitetura, Pr√©-requisitos, Passo a Passo, etc.) to mirror a tutorial flow, which is the most intuitive user experience for this type of content. Key interactions include smooth scrolling navigation and copy-to-clipboard buttons for code blocks, minimizing user effort and errors. This structure was chosen to make a dense, technical document scannable and easy to follow, allowing users to either read sequentially or jump directly to the section they need. -->
    <!-- Visualization & Content Choices: Report Info: Kubernetes setup process. Goal: Guide the user. Presentation: Numbered steps with code blocks. Interaction: Copy-to-clipboard buttons. Justification: Reduces manual copy-paste errors, speeding up the setup process. Report Info: System architecture diagrams. Goal: Organize & Inform. Presentation: Recreated using structured HTML/CSS with Tailwind to represent components and flows. Interaction: Static visual aid. Justification: Adheres to NO SVG/Mermaid constraint while providing necessary visual context for the system's structure. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
            color: #334155; /* slate-700 */
        }
        .code-block {
            position: relative;
        }
        .copy-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background-color: #475569; /* slate-600 */
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            cursor: pointer;
            opacity: 0.5;
            transition: opacity 0.3s;
        }
        .code-block:hover .copy-btn {
            opacity: 1;
        }
        .diagram-box {
            border: 1px solid #cbd5e1; /* slate-300 */
            background-color: #ffffff;
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            font-size: 0.875rem;
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        }
        .diagram-arrow {
            position: relative;
            margin: 1rem 0;
            color: #64748b; /* slate-500 */
        }
        .diagram-arrow::after {
            content: '‚Üì';
            font-size: 1.5rem;
            font-weight: bold;
        }
        html {
            scroll-behavior: smooth;
        }
        .nav-link {
            transition: color 0.3s, border-bottom-color 0.3s;
        }
    </style>
</head>
<body class="bg-slate-50">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-10 shadow-sm">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <span class="font-bold text-xl text-slate-800">üöÄ Guia de Setup - Tech Challenge</span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#arquitetura" class="nav-link text-slate-600 hover:text-slate-900 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent hover:border-amber-500">Arquitetura</a>
                        <a href="#pre-requisitos" class="nav-link text-slate-600 hover:text-slate-900 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent hover:border-amber-500">Pr√©-requisitos</a>
                        <a href="#execucao" class="nav-link text-slate-600 hover:text-slate-900 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent hover:border-amber-500">Execu√ß√£o</a>
                        <a href="#escalabilidade" class="nav-link text-slate-600 hover:text-slate-900 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent hover:border-amber-500">Escalabilidade</a>
                        <a href="#limpeza" class="nav-link text-slate-600 hover:text-slate-900 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent hover:border-amber-500">Limpeza</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">

        <section id="intro" class="text-center mb-16">
            <h1 class="text-4xl md:text-5xl font-bold text-slate-900 mb-4">Guia de Setup e Execu√ß√£o</h1>
            <p class="max-w-3xl mx-auto text-lg text-slate-600">Projeto Tech Challenge FIAP com explica√ß√£o e informa√ß√£o de como rodar no Kubernetes (Minikube). Um passo a passo completo para configurar e rodar a solu√ß√£o em um ambiente de desenvolvimento local.</p>
        </section>

        <section id="arquitetura" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-800 border-b-2 border-amber-400 pb-2 mb-8">1. Arquitetura da Solu√ß√£o Local</h2>
            <p class="text-slate-600 mb-8">Antes de come√ßar, √© importante entender a estrutura que eu montei. O sistema √© composto por uma API (.NET), um Worker de background e um Banco de Dados (SQL Server), todos rodando como cont√™ineres independentes dentro de um cluster Kubernetes.</p>
            
            <div class="bg-white p-6 rounded-lg shadow-lg">
                <h3 class="text-xl font-semibold text-slate-700 mb-4 text-center">Diagrama de Infraestrutura</h3>
                <div class="diagram-box bg-slate-100">Cluster Kubernetes (Minikube)</div>
                <div class="diagram-arrow"></div>
                <div class="grid md:grid-cols-3 gap-4 text-center">
                    <div class="diagram-box">Pod(s) da API ‚ÜîÔ∏è HPA</div>
                    <div class="diagram-box">Pod(s) do Worker</div>
                    <div class="diagram-box">Pod do Banco de Dados</div>
                </div>
                 <div class="diagram-arrow"></div>
                <div class="diagram-box bg-slate-100">Servi√ßos (API Service, DB Service)</div>
                 <div class="diagram-arrow"></div>
                <div class="grid md:grid-cols-2 gap-4 text-center">
                     <div class="diagram-box">Desenvolvedor ‚ÜîÔ∏è API Service</div>
                     <div class="diagram-box">Pods ‚ÜîÔ∏è DB Service ‚ÜîÔ∏è Armazenamento Persistente</div>
                </div>
            </div>
        </section>

        <section id="pre-requisitos" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-800 border-b-2 border-amber-400 pb-2 mb-8">2. Pr√©-requisitos (Preparando a M√°quina)</h2>
            <p class="text-slate-600 mb-6">Garanta que as seguintes ferramentas estejam instaladas e funcionando antes de prosseguir.</p>
            <ul class="list-none space-y-4">
                <li class="flex items-start"><span class="text-amber-500 font-bold text-2xl mr-4">1</span><div class="flex-1"><strong class="text-slate-700">Git:</strong> Para clonar o reposit√≥rio. <a href="https://github.com/alealencarr/TechChallenge.git" target="_blank" class="text-blue-600 hover:underline">Download</a>.</div></li>
                <li class="flex items-start"><span class="text-amber-500 font-bold text-2xl mr-4">2</span><div class="flex-1"><strong class="text-slate-700">.NET 9 SDK.</strong></div></li>
                <li class="flex items-start"><span class="text-amber-500 font-bold text-2xl mr-4">3</span><div class="flex-1"><strong class="text-slate-700">Docker Desktop.</strong> Ambiente de cont√™ineres para Windows. <a href="https://www.docker.com/products/docker-desktop/" target="_blank" class="text-blue-600 hover:underline">Download</a>.</div></li>
                <li class="flex items-start"><span class="text-amber-500 font-bold text-2xl mr-4">4</span><div class="flex-1"><strong class="text-slate-700">Minikube:</strong> Cluster Kubernetes local. Instale via PowerShell (Admin): <code class="bg-slate-200 text-sm p-1 rounded">winget install Kubernetes.minikube</code>.</div></li>
                <li class="flex items-start"><span class="text-amber-500 font-bold text-2xl mr-4">5</span><div class="flex-1"><strong class="text-slate-700">kubectl:</strong> Ferramenta de linha de comando para K8s. Verifique com <code class="bg-slate-200 text-sm p-1 rounded">kubectl version --client</code>.</div></li>
            </ul>
        </section>
        
        <section id="execucao" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-800 border-b-2 border-amber-400 pb-2 mb-8">3. Passo a Passo da Execu√ß√£o</h2>
            <div class="space-y-8">
                <div>
                    <h3 class="text-xl font-semibold text-slate-700 mb-2">Passo 1: Clonar o Reposit√≥rio</h3>
                    <div class="code-block">
                        <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash">git clone &lt;https://github.com/alealencarr/TechChallenge.git&gt;
cd &lt;TechChallenge&gt;</code></pre>
                        <button class="copy-btn">Copiar</button>
                    </div>
                </div>
                <div>
                    <h3 class="text-xl font-semibold text-slate-700 mb-2">Passo 2: Construir as Imagens Docker</h3>
                    <p class="text-slate-600 mb-4">Construa as imagens para a API e o Worker.</p>
                    <div class="code-block mb-4">
                        <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash">docker build -t api-k8s:v1 -f api.dockerfile .</code></pre>
                        <button class="copy-btn">Copiar</button>
                    </div>
                    <div class="code-block">
                        <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash">docker build -t worker-k8s:v1 -f job.dockerfile .</code></pre>
                        <button class="copy-btn">Copiar</button>
                    </div>
                </div>
                <div>
                    <h3 class="text-xl font-semibold text-slate-700 mb-2">Passo 3: Iniciar e Preparar o Cluster Kubernetes</h3>
                     <div class="code-block mb-4">
                        <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash">minikube start --memory 4g --cpus 2</code></pre>
                        <button class="copy-btn">Copiar</button>
                    </div>
                    <div class="code-block">
                        <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash">minikube addons enable metrics-server</code></pre>
                        <button class="copy-btn">Copiar</button>
                    </div>
                </div>
                <div>
                    <h3 class="text-xl font-semibold text-slate-700 mb-2">Passo 4: Carregar as Imagens para o Minikube</h3>
                    <div class="code-block mb-4">
                        <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash">docker image save -o imageApi.tar api-k8s:v1</code></pre>
                        <button class="copy-btn">Copiar</button>
                                              
                    </div>
                    <div class="code-block mb-4"> 
                    <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash">minikube image load imageApi.tar</code></pre>
                        <button class="copy-btn">Copiar</button>
                        
                    </div>
                    <div class="code-block mb-4">
                        <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash">docker image save -o imageJob.tar worker-k8s:v1</code></pre>
                        <button class="copy-btn">Copiar</button>                        
                    </div>

                    <div class="code-block mb-4"> 
                    <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash">minikube image load imageJob.tar</code></pre>
                        <button class="copy-btn">Copiar</button>
                        </div>
                </div>
                <div>
                    <h3 class="text-xl font-semibold text-slate-700 mb-2">Passo 5: Deploy da Aplica√ß√£o no Kubernetes</h3>
                    <div class="code-block mb-4">
                        <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash">kubectl apply -f k8s/</code></pre>
                        <button class="copy-btn">Copiar</button>
                    </div>

                </div>
                 <div>
                    <h3 class="text-xl font-semibold text-slate-700 mb-2">Passo 6: Verificar a Execu√ß√£o</h3>
                    <p class="text-slate-600 mb-4">Monitore os Pods at√© que todos estejam com o status `Running`. Lembre-se que reinicializa√ß√µes (`CrashLoopBackOff`) s√£o normais enquanto o banco de dados inicia.</p>
                    <div class="code-block">
                        <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash">kubectl get pods -w</code></pre>
                        <button class="copy-btn">Copiar</button>
                    </div>
                </div>
                 <div>
                    <h3 class="text-xl font-semibold text-slate-700 mb-2">Passo 7: Acessar e Testar a API</h3>
                    <div class="code-blockmb-4">
                        <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash">minikube service api-service-tc</code></pre>
                        <button class="copy-btn">Copiar</button>
                    </div>
                     <p class="text-slate-600 mt-4">Este comando abrir√° a URL da sua API no navegador. Adicione `/swagger` ao final para ver a documenta√ß√£o e testar.</p>
                </div>
                <div> 
                    <h3 class="text-xl font-semibold text-slate-700 mb-2">Passo 8: Com todos os pods "RUNNING" aponte para a porta 8080 para testar a collection.</h3>
                    <div class="code-block mb-4">
                        <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash">kubectl port-forward service/api-service-tc 8080:80</code></pre>
                        <button class="copy-btn">Copiar</button>
                    </div>
                </div>
            </div>
        </section>

        <section id="escalabilidade" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-800 border-b-2 border-amber-400 pb-2 mb-8">4. Entendendo a Escalabilidade Autom√°tica (HPA)</h2>
            <div class="bg-white p-6 rounded-lg shadow-lg space-y-4">
                <p class="text-slate-600">A escalabilidade √© controlada pelo <strong>Horizontal Pod Autoscaler (HPA)</strong>. A regra √© baseada no consumo de CPU para garantir que a aplica√ß√£o tenha os recursos necess√°rios sob alta carga.</p>
                <ul class="list-disc list-inside space-y-2 text-slate-600">
                    <li><strong class="text-slate-700">Configura√ß√£o:</strong> Cada pod da API solicita <code class="bg-slate-200 text-sm p-1 rounded">100m</code> (10% de um n√∫cleo de CPU).</li>
                    <li><strong class="text-slate-700">Regra:</strong> O HPA foi configurado para manter o uso m√©dio de CPU em <code class="bg-slate-200 text-sm p-1 rounded">50%</code> do solicitado.</li>
                    <li><strong class="text-slate-700">Limites:</strong> A aplica√ß√£o escalar√° de um m√≠nimo de <code class="bg-slate-200 text-sm p-1 rounded">1</code> pod at√© um m√°ximo de <code class="bg-slate-200 text-sm p-1 rounded">9</code> pods.</li>
                </ul>
                 <p class="text-slate-600">Quando a carga na API faz com que o uso m√©dio de CPU ultrapasse o gatilho de 50%, o HPA come√ßa a criar novos pods para distribuir o trabalho. Quando a carga diminui, o processo inverso ocorre.</p>
                 <div class="code-block">
                        <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash"># Monitore o HPA em tempo real com este comando
kubectl get hpa -w</code></pre>
                        <button class="copy-btn">Copiar</button>
                    </div>
            </div>
        </section>

        <section id="limpeza" class="scroll-mt-20">
             <h2 class="text-3xl font-bold text-slate-800 border-b-2 border-amber-400 pb-2 mb-8">5. Como Limpar o Ambiente</h2>
             <p class="text-slate-600 mb-6">Quando terminar os testes, use os seguintes comandos para limpar os recursos e liberar mem√≥ria do seu computador.</p>
             <div class="space-y-8">
                 <div>
                    <h3 class="text-xl font-semibold text-slate-700 mb-2">Deletar os recursos do Kubernetes</h3>
                    <div class="code-block">
                        <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash">kubectl delete -f k8s/</code></pre>
                        <button class="copy-btn">Copiar</button>
                    </div>
                </div>
                <div>
                    <h3 class="text-xl font-semibold text-slate-700 mb-2">Parar o Minikube</h3>
                    <div class="code-block">
                        <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash">minikube stop</code></pre>
                        <button class="copy-btn">Copiar</button>
                    </div>
                </div>
                 <div>
                    <h3 class="text-xl font-semibold text-slate-700 mb-2">(Opcional) Deletar o cluster completamente</h3>
                    <div class="code-block">
                        <pre class="bg-slate-800 text-white p-4 rounded-lg overflow-x-auto"><code class="language-bash">minikube delete</code></pre>
                        <button class="copy-btn">Copiar</button>
                    </div>
                </div>
             </div>
        </section>
    </main>

    <footer class="bg-slate-800 text-slate-400 mt-16">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 text-center text-sm">
            <p>Guia de Setup gerado para o Projeto de Log√≠stica. Vers√£o 1.1</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const copyButtons = document.querySelectorAll('.copy-btn');
            copyButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const codeBlock = button.previousElementSibling.querySelector('code');
                    const textToCopy = codeBlock.innerText;
                    
                    navigator.clipboard.writeText(textToCopy).then(() => {
                        button.innerText = 'Copiado!';
                        setTimeout(() => {
                            button.innerText = 'Copiar';
                        }, 2000);
                    }).catch(err => {
                        console.error('Falha ao copiar texto: ', err);
                    });
                });
            });

            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                });
            });
        });
    </script>
</body>
</html> 
